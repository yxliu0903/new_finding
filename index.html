<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture Discovery</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background: white;
            min-height: 100vh;
            overflow: hidden;
        }

        .container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .title {
            text-align: center;
            color: #333;
            font-size: 1.5em;
            margin: 10px 0;
            font-weight: bold;
        }

        .discovery-canvas {
            flex: 1;
            position: relative;
            background: white;
            overflow: hidden;
        }

        .base-image {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60%;
            height: 60%;
            background: #f5f5f5;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: #999;
            opacity: 0.2;
            z-index: 1;
        }

        .architecture-layer {
            position: absolute;
            width: 20%;
            height: 25%;
            opacity: 0;
            transition: all 0.5s ease-in-out;
            z-index: 2;
            border-radius: 8px;
            overflow: hidden;
            transform: scale(0.8);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .architecture-layer.active {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }

        .architecture-layer.new-finding {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            border: 2px solid #ffd700;
        }

        .new-finding-label {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(45deg, #ff6b6b, #ffd700);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.8em;
            z-index: 10;
        }

        .progress-bar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 6px;
            background: #eee;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 3px;
        }

        .info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 8px;
            font-size: 0.8em;
            color: #333;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .milestone {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #ff6b6b, #ffd700);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 1.2em;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            transition: all 0.5s ease;
            z-index: 100;
            text-align: center;
        }

        .milestone.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        /* SVGÊ†∑Âºè‰ºòÂåñ */
        .architecture-layer svg {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* ÊéßÂà∂ÊåâÈíÆ */
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
        }

        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #5a6fd8;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">üöÄ AI Architecture Discovery</div>
        
        <div class="controls">
            <button class="btn" id="startBtn">ÂºÄÂßã</button>
            <button class="btn" id="pauseBtn" disabled>ÊöÇÂÅú</button>
            <button class="btn" id="resetBtn">ÈáçÁΩÆ</button>
        </div>

        <div class="discovery-canvas" id="discoveryCanvas">
            <div class="base-image">
                <div>üß† AI Foundation</div>
            </div>
        </div>

        <div class="info" id="info">
            <div>ËøõÂ∫¶: <span id="progress">0/0</span></div>
            <div>Êñ∞ÂèëÁé∞: <span id="newFindings">0</span></div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="milestone" id="milestone">
            üéâ 37 Move Moment!<br>
            <span style="font-size: 0.8em;">Êû∂ÊûÑÂèëÁé∞ÁöÑÂÖ≥ÈîÆÊó∂Âàª</span>
        </div>
    </div>

    <script>
        class ArchitectureDiscovery {
            constructor() {
                this.architectures = [];
                this.currentIndex = 0;
                this.isPlaying = false;
                this.newFindingsCount = 0;
                this.milestoneShown = false;
                this.autoPlayInterval = null;
                
                this.init();
            }

            async init() {
                try {
                    console.log('ÂºÄÂßãÂä†ËΩΩÊû∂ÊûÑÊï∞ÊçÆ...');
                    const response = await fetch('data/106.json');
                    console.log('Êï∞ÊçÆÂìçÂ∫îÁä∂ÊÄÅ:', response.status);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    this.architectures = await response.json();
                    console.log('ÊàêÂäüÂä†ËΩΩÊû∂ÊûÑÊï∞ÊçÆÔºåÂÖ±', this.architectures.length, '‰∏™Êù°ÁõÆ');
                    
                    this.updateInfo();
                    this.setupEventListeners();
                    
                    // Ëá™Âä®ÂºÄÂßãÊí≠Êîæ
                    setTimeout(() => {
                        console.log('ÂºÄÂßãËá™Âä®Êí≠Êîæ...');
                        this.startDiscovery();
                    }, 1000);
                } catch (error) {
                    console.error('Error loading architectures:', error);
                    this.showError('Êó†Ê≥ïÂä†ËΩΩÊû∂ÊûÑÊï∞ÊçÆ: ' + error.message);
                }
            }

            setupEventListeners() {
                document.getElementById('startBtn').addEventListener('click', () => this.startDiscovery());
                document.getElementById('pauseBtn').addEventListener('click', () => this.pauseDiscovery());
                document.getElementById('resetBtn').addEventListener('click', () => this.resetDiscovery());
            }

            startDiscovery() {
                if (this.currentIndex >= this.architectures.length) {
                    this.resetDiscovery();
                }
                this.isPlaying = true;
                document.getElementById('startBtn').disabled = true;
                document.getElementById('pauseBtn').disabled = false;
                
                // Ê∏ÖÈô§‰πãÂâçÁöÑÂÆöÊó∂Âô®
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                }
                
                // ËÆæÁΩÆ100msÈó¥ÈöîÁöÑËá™Âä®Êí≠Êîæ
                this.autoPlayInterval = setInterval(() => {
                    if (this.isPlaying) {
                this.showNextArchitecture();
                    }
                }, 100);
            }

            pauseDiscovery() {
                this.isPlaying = false;
                document.getElementById('startBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = true;
                
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                    this.autoPlayInterval = null;
                }
            }

            resetDiscovery() {
                this.currentIndex = 0;
                this.newFindingsCount = 0;
                this.milestoneShown = false;
                this.isPlaying = false;
                this.clearCanvas();
                this.updateInfo();
                document.getElementById('startBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = true;
                document.getElementById('milestone').classList.remove('show');
                
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                    this.autoPlayInterval = null;
                }
            }

            clearCanvas() {
                const canvas = document.getElementById('discoveryCanvas');
                const layers = canvas.querySelectorAll('.architecture-layer');
                layers.forEach(layer => layer.remove());
            }

            showNextArchitecture() {
                console.log('ÊòæÁ§∫Á¨¨', this.currentIndex + 1, '‰∏™Êû∂ÊûÑ');
                
                if (this.currentIndex >= this.architectures.length) {
                    console.log('ÊâÄÊúâÊû∂ÊûÑÂ∑≤ÊòæÁ§∫ÂÆåÊØï');
                    this.completeDiscovery();
                    return;
                }

                // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊ∏ÖÁêÜÊóßÁöÑÊû∂ÊûÑÂõæ
                this.cleanupOldLayers();

                const arch = this.architectures[this.currentIndex];
                console.log('ÂΩìÂâçÊû∂ÊûÑ:', arch.name || arch.name_new);
                
                const layer = this.createArchitectureLayer(arch);
                
                // ÈöèÊú∫‰ΩçÁΩÆ
                this.setRandomPosition(layer);
                
                document.getElementById('discoveryCanvas').appendChild(layer);
                
                // Ëß¶ÂèëÂä®Áîª
                setTimeout(() => {
                    layer.classList.add('active');
                }, 50);

                // Ê£ÄÊü•ÊòØÂê¶ÊòØÊñ∞ÂèëÁé∞ÔºàÂàÜÊï∞È´ò‰∫éÂπ≥ÂùáÂÄºÁöÑ1.5ÂÄçÔºâ
                const avgScore = this.getAverageScore();
                if (arch.score > avgScore * 1.5) {
                    this.markAsNewFinding(layer, arch);
                }

                // Ê£ÄÊü•ÈáåÁ®ãÁ¢ë
                if (this.currentIndex === 37 && !this.milestoneShown) {
                    this.showMilestone();
                }

                this.currentIndex++;
                this.updateInfo();
            }

            createArchitectureLayer(arch) {
                const layer = document.createElement('div');
                layer.className = 'architecture-layer';
                
                // ÂàõÂª∫SVGÂÆπÂô®Âπ∂ËÆæÁΩÆÊ†∑Âºè
                const svgContainer = document.createElement('div');
                svgContainer.innerHTML = arch.svg_picture;
                svgContainer.style.width = '100%';
                svgContainer.style.height = '100%';
                svgContainer.style.display = 'flex';
                svgContainer.style.alignItems = 'center';
                svgContainer.style.justifyContent = 'center';
                
                // ‰ºòÂåñSVGÂ§ßÂ∞è
                const svg = svgContainer.querySelector('svg');
                if (svg) {
                    svg.style.width = '100%';
                    svg.style.height = '100%';
                    svg.style.maxWidth = '100%';
                    svg.style.maxHeight = '100%';
                    svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');
                }
                
                layer.appendChild(svgContainer);
                return layer;
            }

            setRandomPosition(layer) {
                const canvas = document.getElementById('discoveryCanvas');
                const canvasRect = canvas.getBoundingClientRect();
                
                // ËÆ°ÁÆóÂèØÁî®Âå∫ÂüüÔºàÂáèÂéªÊû∂ÊûÑÂõæÊú¨Ë∫´ÁöÑÂ∞∫ÂØ∏Ôºâ
                const layerWidth = canvasRect.width * 0.20; // 20%ÂÆΩÂ∫¶
                const layerHeight = canvasRect.height * 0.25; // 25%È´òÂ∫¶
                
                const maxX = canvasRect.width - layerWidth;
                const maxY = canvasRect.height - layerHeight;
                
                // ‰ΩøÁî®Êõ¥ÂØÜÈõÜÁöÑÁΩëÊ†ºÁ≥ªÁªüÊù•Êõ¥Â•ΩÂú∞ÂàÜÂ∏É
                const gridCols = 5;
                const gridRows = 4;
                const cellWidth = maxX / gridCols;
                const cellHeight = maxY / gridRows;
                
                // ÈöèÊú∫ÈÄâÊã©‰∏Ä‰∏™ÁΩëÊ†ºÂçïÂÖÉ
                const gridX = Math.floor(Math.random() * gridCols);
                const gridY = Math.floor(Math.random() * gridRows);
                
                // Âú®ÁΩëÊ†ºÂçïÂÖÉÂÜÖÈöèÊú∫‰ΩçÁΩÆÔºåÁïôÂá∫ËæπË∑ù
                const margin = 20;
                const x = gridX * cellWidth + margin + Math.random() * (cellWidth - layerWidth - margin * 2);
                const y = gridY * cellHeight + margin + Math.random() * (cellHeight - layerHeight - margin * 2);
                
                // ËÆæÁΩÆ‰ΩçÁΩÆ
                layer.style.left = x + 'px';
                layer.style.top = y + 'px';
                
                // Ê∑ªÂä†ÈöèÊú∫ÊóãËΩ¨ÂíåÁº©ÊîæÂèòÂåñ
                const rotation = (Math.random() - 0.5) * 30; // -15Â∫¶Âà∞+15Â∫¶
                const scale = 0.7 + Math.random() * 0.3; // 0.7Âà∞1.0‰πãÈó¥
                layer.style.transform = `scale(${scale}) rotate(${rotation}deg)`;
            }

            cleanupOldLayers() {
                const layers = document.querySelectorAll('.architecture-layer');
                const maxLayers = 20; // ÊúÄÂ§ö‰øùÁïô20‰∏™Êû∂ÊûÑÂõæ
                
                if (layers.length > maxLayers) {
                    // ÁßªÈô§ÊúÄÊóßÁöÑÂá†‰∏™Êû∂ÊûÑÂõæ
                    const layersToRemove = layers.length - maxLayers;
                    for (let i = 0; i < layersToRemove; i++) {
                        if (layers[i]) {
                            layers[i].style.opacity = '0';
                            layers[i].style.transform = 'scale(0.5) rotate(45deg)';
                            setTimeout(() => {
                                if (layers[i] && layers[i].parentNode) {
                                    layers[i].parentNode.removeChild(layers[i]);
                                }
                            }, 300);
                        }
                    }
                }
            }

            markAsNewFinding(layer, arch) {
                layer.classList.add('new-finding');
                
                const label = document.createElement('div');
                label.className = 'new-finding-label';
                label.textContent = 'NEW FINDINGS!';
                layer.appendChild(label);
                
                this.newFindingsCount++;
            }

            showMilestone() {
                this.milestoneShown = true;
                const milestone = document.getElementById('milestone');
                milestone.classList.add('show');
                
                setTimeout(() => {
                    milestone.classList.remove('show');
                }, 3000);
            }

            getAverageScore() {
                const scores = this.architectures.map(arch => arch.score).filter(score => score !== null && score !== undefined);
                return scores.length > 0 ? scores.reduce((a, b) => a + b, 0) / scores.length : 0;
            }

            updateInfo() {
                document.getElementById('progress').textContent = `${this.currentIndex}/${this.architectures.length}`;
                document.getElementById('newFindings').textContent = this.newFindingsCount;
                
                const progress = (this.currentIndex / this.architectures.length) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
            }

            completeDiscovery() {
                this.isPlaying = false;
                document.getElementById('startBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = true;
                
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                    this.autoPlayInterval = null;
                }
                
                // ÊòæÁ§∫ÂÆåÊàê‰ø°ÊÅØ
                const milestone = document.getElementById('milestone');
                milestone.innerHTML = 'üéâ ÂèëÁé∞ÂÆåÊàê!<br><span style="font-size: 0.8em;">ÂÖ±ÂèëÁé∞ ' + this.newFindingsCount + ' ‰∏™ÈáçË¶ÅÁ™ÅÁ†¥</span>';
                milestone.classList.add('show');
                
                setTimeout(() => {
                    milestone.classList.remove('show');
                }, 5000);
            }

            showError(message) {
                alert('ÈîôËØØ: ' + message);
            }
        }

        // ÂàùÂßãÂåñÂ∫îÁî®
        document.addEventListener('DOMContentLoaded', () => {
            new ArchitectureDiscovery();
        });
    </script>
</body>
</html> 